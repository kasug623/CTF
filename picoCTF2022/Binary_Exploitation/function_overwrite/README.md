# Lessons


# Memo
1. check
```zsh
$ file vuln
vuln: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=8b6f3ccbb344c3ba91ef077e29c8ab9d6e2da011, for GNU/Linux 3.2.0, not stripped
$
$ checksec --file=./vuln --output=json | jq .
{
  "./vuln": {
    "relro": "partial",
    "canary": "no",
    "nx": "yes",
    "pie": "no",
    "rpath": "no",
    "runpath": "no",
    "symbols": "yes",
    "fortify_source": "no",
    "fortified": "0",
    "fortify-able": "2"
  }
}
```

2. ghidra

3. logic
- arg1
  ```
  } ... 125
  W ... 87
  "}" * 10 + "W" = 125 * 10 + 87 = 1337
  ```
  input : }}}}}}}}}}W
- arg2
```
...
  *EBX  0x804c000 (_GLOBAL_OFFSET_TABLE_) —▸ 0x804bf10 (_DYNAMIC) ◂— 0x1

0x8049614 <vuln+164>    mov    esi, dword ptr [ebx + 0x40]

  *ESI  0x8049436 (hard_checker) ◂— endbr32
...
0x8049637 <vuln+199>    call   esi
```


now
```
0804c040 36  94  04  08    addr                 hard_checker ... 08049436
```
->
```
0804c040 fc  92  04  08    addr                 easy_checker ... 080492fc
```