# Lesson
- how to write solver with javascript

# Writeup
1. check source
2. deobufuscate javascript using web  
    https://lelinhtinh.github.io/de4js/
3. write solver  
    I don't manually read the code.  
    ```js
    function myReplaceString(str, start, end, replacement) {
        return str.substring(0, start) + replacement + str.substring(end);
    }

    function verify() {
        //checkpass = document[_0x4b5b('0x0')]('pass')[_0x4b5b('0x1')];
        split = 0x4;
        //   if (checkpass[_0x4b5b('0x2')](0x0, split * 0x2) == _0x4b5b('0x3')) {
        //     if (checkpass[_0x4b5b('0x2')](0x7, 0x9) == '{n') {
        //       if (checkpass[_0x4b5b('0x2')](split * 0x2, split * 0x2 * 0x2) == _0x4b5b('0x4')) {
        //         if (checkpass[_0x4b5b('0x2')](0x3, 0x6) == 'oCT') {
        //           if (checkpass[_0x4b5b('0x2')](split * 0x3 * 0x2, split * 0x4 * 0x2) == _0x4b5b('0x5')) {
        //             if (checkpass.substring(0x6, 0xb) == 'F{not') {
        //               if (checkpass[_0x4b5b('0x2')](split * 0x2 * 0x2, split * 0x3 * 0x2) == _0x4b5b('0x6')) {
        //                 if (checkpass[_0x4b5b('0x2')](0xc, 0x10) == _0x4b5b('0x7')) {
        //                   alert(_0x4b5b('0x8'));
        //                 }
        //               }
        //             }
        //           }
        //         }
        //       }
        //     }
        //   } else {
        //     alert(_0x4b5b('0x9'));
        //   }

        var flag = "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
        flag = myReplaceString(flag, 0x0, split * 0x2, _0x4b5b('0x3'));
        flag = myReplaceString(flag, 0x7, 0x9, '{n');
        flag = myReplaceString(flag, split * 0x2, split * 0x2 * 0x2, _0x4b5b('0x4'));
        flag = myReplaceString(flag, 0x3, 0x6, 'oCT');
        flag = myReplaceString(flag, split * 0x3 * 0x2, split * 0x4 * 0x2, _0x4b5b('0x5'));
        flag = myReplaceString(flag, 0x6, 0xb, 'F{not');
        flag = myReplaceString(flag, split * 0x2 * 0x2, split * 0x3 * 0x2, _0x4b5b('0x6'));
        flag = myReplaceString(flag, 0xc, 0x10, _0x4b5b('0x7'));

        console.log(flag)

    }

    verify();
    ```
    ```zsh
    $ which js
    /usr/bin/js
    $ js solver.js
    picoCTF{not_this_again_50a029}11111111111111111111111111111111111111111111111111111111111111111111111111
    ```