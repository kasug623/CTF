# Lesson Learn
- LIBC
- pwninit
- PIE on Linux Binary
- Makefile
- ROPgadget
- GOT
- PLT
- gdb-peda
    - pattern_create
    - pattern_offset
- pwntools
    - recv(6)
        comination of `recvline()` and ``
        ```python
        a = recvline()
        print(len(a))
        # 6
        recv(6).ljust(8,b"\x00")
        ```
- `readelf`
    - `-s`  
        -s or --symbols: Display the symbol table.

# Write Up
1. fix binary
```zsh
$ pwninit --bin ./vuln --libc ./libc.so.6
```

```
$ ldd ./vuln
$ strings libc.so.6 | grep -i version

$ checksec --file=./vuln_patched --format=json | jq .
```

2. ghidra

3. gdb-peda
```
$ continue
stack
info register
info break
b *0x4006ef # scanf
 break *0x400770 # return
# over flow
pattern_create 200
pattc 200
AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA
# copy-and-paste
pattern_offset 
```

4. think about ROP

5. pwntools
- p64

- calculate static offset
    ```console
    $ readelf -s ./libc.so.6 | grep puts
    191: 0000000000080a30   512 FUNC    GLOBAL DEFAULT   13 _IO_puts@@GLIBC_2.2.5
    422: 0000000000080a30   512 FUNC    WEAK   DEFAULT   13 puts@@GLIBC_2.2.5
    496: 0000000000126870  1240 FUNC    GLOBAL DEFAULT   13 putspent@@GLIBC_2.2.5
    678: 0000000000128780   750 FUNC    GLOBAL DEFAULT   13 putsgent@@GLIBC_2.10
    1141: 000000000007f260   396 FUNC    WEAK   DEFAULT   13 fputs@@GLIBC_2.2.5
    ```
    pwntools
    ```python
    ...
    libc_base=addr-libc.symbols['puts']
    print("static offset ...")
    print(hex(libc.symbols['puts']))
    # 0x80a30
    ...
    ```
6. think about the next ROP


# Ref  
- https://papadoxie.github.io/Writeups/PicoCTF/HeresALIBC/HeresALIBC.html  
- https://cashitsuki.com/posts/2021-12-15-pwninit-manually/  
- https://qiita.com/Hashibirokou/items/8d76fc88bd6daaf8f067  
- https://ret2home.github.io/blog/CTF/picoctf-2021/pwn/hereslibc/
 -https://sh0ebill.hatenablog.com/entry/2022/09/08/211727
- https://qiita.com/tobira-code/items/7ae54a22158aea1a8579  