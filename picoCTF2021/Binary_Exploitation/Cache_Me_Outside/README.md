# Lesson
- `pwndbg`
  ```zsh
  pwndbg> cyclic 200
  aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaa
  pwndbg> cyclic --offset baaaaaaacaaaaaaadaa
  Lookup pattern must be 8 bytes (use `-n <length>` to lookup pattern of different length)
  pwndbg> cyclic --offset baaaaaaaca
  Lookup pattern must be 8 bytes (use `-n <length>` to lookup pattern of different length)
  pwndbg> cyclic --offset baaaaaaa
  Finding cyclic pattern of 8 bytes: b'baaaaaaa' (hex: 0x6261616161616161)
  Found at offset 8
  ```
- `strcat`  
  C library function.   
   `strcat` is a standard C library function used for string concatenation.  
   ```c
   char *strcat(char *dest, const char *src);
   ```
- `__isoc99_scanf`  
  a function in the C programming language that is part of the standard library.  
  It is an implementation-specific function used for formatted input, similar to `scanf`.   The double underscores in the name suggest that it is intended for internal use and may be specific to certain compilers or environments.  

  The `__isoc99_scanf` function is essentially a variant of the standard `scanf` function that conforms to the ISO C99 standard.  
  The ISO C99 standard introduced some changes and additions to the C language, and `__isoc99_scanf` is intended to support these changes.  

  The prototype for `__isoc99_scanf` is similar to that of scanf.  

  ```c
  int __isoc99_scanf(const char *format, ...);
  ```

  It's worth noting that for most practical purposes, you can often use the standard `scanf` function instead of `__isoc99_scanf` in your code. The use of `__isoc99_scanf` might be necessary in certain environments that strictly adhere to the ISO C99 standard.

  In this example, __isoc99_scanf is used to read an integer from the user and then print it back.  
  ```c
  #include <stdio.h>

  int main() {
      int num;
      printf("Enter a number: ");
      __isoc99_scanf("%d", &num);
      printf("You entered: %d\n", num);

      return 0;
  }
  ```

# Memo
1. fix binary
```zsh
$ file ./heapedit
heapedit: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=6967c296c25feb50c480b4edb5c56c234bb30392, not stripped
$
$ ldd ./heapedit
        linux-vdso.so.1 (0x00007ffef03fb000)
        libc.so.6 => ./libc.so.6 (0x00007ff0fa200000)
        /lib64/ld-linux-x86-64.so.2 (0x00007ff0fa7b2000)
$
$ ./heapedit
Inconsistency detected by ld.so: dl-call-libc-early-init.c: 37: _dl_call_libc_early_init: Assertion 'sym != NULL' failed!
$
$ pwninit
bin: ./heapedit
libc: ./libc.so.6

fetching linker
https://launchpad.net/ubuntu/+archive/primary/+files//libc6_2.27-3ubuntu1.2_amd64.deb
unstripping libc
https://launchpad.net/ubuntu/+archive/primary/+files//libc6-dbg_2.27-3ubuntu1.2_amd64.deb
warning: failed unstripping libc: failed running eu-unstrip, please install elfutils: No such file or directory (os error 2)
copying ./heapedit to ./heapedit_patched
running patchelf on ./heapedit_patched  
writing solve.py stub
$
$ ldd ./heapedit_patched
        linux-vdso.so.1 (0x00007ffd7a0c0000)
        libc.so.6 => ./libc.so.6 (0x00007fb47f400000)
        ./ld-2.27.so => /lib64/ld-linux-x86-64.so.2 (0x00007fb47f9bd000)
$
$ ./heapedit_patched
zsh: segmentation fault  ./heapedit_patched
```

2. check
```zsh
$ checksec --file=heapedit_patched --output=json | jq .
```
```json
{
  "heapedit_patched": {
    "relro": "partial",
    "canary": "yes",
    "nx": "yes",
    "pie": "no",
    "rpath": "no",
    "runpath": "yes",
    "symbols": "yes",
    "fortify_source": "no",
    "fortified": "0",
    "fortify-able": "3"
  }
}
```

3. ltrace
```zsh
$ ./heapedit_patched
zsh: segmentation fault  ./heapedit_patched
$
$ ltrace ./heapedit_patched
setbuf(0x7fe47fa55760, 0)                                                 = <void>
fopen("flag.txt", "r")                                                    = 0
fgets( <no return ...>
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++
$
$ touch flag.txt
$
$ ./heapedit_patched
You may edit one byte in the program.
Address:
...
```